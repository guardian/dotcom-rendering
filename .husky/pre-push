currentBranch="$(git rev-parse --abbrev-ref HEAD)"

if [[ $currentBranch == "main" ]]
then
	echo "⚠️ You should not push to the \`main\` branch"
	exit 1
fi

if git diff-tree --no-commit-id --name-only -r HEAD..origin/$currentBranch | grep -q 'ab-testing/'; then
  	cd ./$(dirname "$0")/../ab-testing
	deno test && deno run validate
fi

cd ./$(dirname "$0")/../dotcom-rendering
make tsc
